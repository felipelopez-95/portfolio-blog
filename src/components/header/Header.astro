---
import Menu from "./Menu.astro";
import Nav from "./Nav.astro";
import Theme from "./Theme.astro";
import logoIcon from "../../assets/logo.svg";
---

<header class="header">
    <div class="header-nav-container">
        <div class="nav-logo">
            <a href="#intro" class="nav-logo-img">
                <img src={logoIcon.src} alt="Logo" width="24" height="24" />
            </a>
        </div>

        <div class="header-nav-wrapper">
            <Nav />
        </div>

        <div class="header-controls">
            <div class="nav-mode">
                <Theme />
            </div>

            <div class="header-button-wrapper">
                <Menu />
            </div>
        </div>
    </div>
</header>

<style>
    /* 1. Estilos Base (Móvil) */
    .header {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 52px; /* Más compacto */
        display: flex;
        align-items: center;
        padding: 0 1rem;
        z-index: 1000;
        background-color: transparent;
    }

    .header-nav-container {
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;
        transition: all 0.3s ease;
        border-radius: 99px;
        padding: 0;
        border: 1px solid transparent;
    }

    .header-controls {
        display: flex;
        align-items: center;
        gap: 0.2rem;
        background: var(--bg-secondary);
        border-radius: 12px;
        padding-right: 4px;
        transition: all 0.3s ease;
    }

    .nav-mode {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 44px;
        height: 44px;
    }

    .header-nav-wrapper {
        display: none;
    }

    .header-nav-wrapper.show {
        display: block;
        position: absolute;
        top: 52px;
        left: 0;
        width: 100%;
        background-color: transparent;
    }

    .nav-logo-img {
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .nav-logo-img img {
        display: block;
    }

    /* Efecto scroll en móvil: más ajustado */
    .header-nav-container.on-scroll {
        background-color: var(--bg-secondary);
        border: 1px solid rgba(255, 255, 255, 0.05);
        box-shadow: var(--box-shadow);
        padding: 0 0.8rem; /* Menos ancho horizontal */
    }

    /* Al hacer scroll, los controles se funden con el fondo general */
    .header-nav-container.on-scroll .header-controls {
        background: transparent;
        padding-right: 0;
    }

    /* 2. Estilos Desktop (768px+) */
    @media (min-width: 768px) {
        .header {
            justify-content: center;
            padding: 0;
        }

        .header-nav-container {
            width: auto;
            padding: 0.2rem 1.5rem;
            justify-content: center;
        }

        .header-nav-container.on-scroll {
            padding: 0.2rem 1.5rem;
        }

        .header-controls {
            background: transparent;
            padding: 0;
            gap: 1.5rem;
        }

        .nav-mode {
            width: auto;
            height: auto;
        }

        .header-nav-wrapper {
            display: block;
        }

        .header-button-wrapper {
            display: none;
        }

        .header-nav-wrapper.show {
            position: static;
        }
    }
</style>

<script>
    const menu = document.querySelector("#menu");
    const navWrapper = document.querySelector(".header-nav-wrapper");
    const navContainer = document.querySelector(".header-nav-container");

    // Lógica del menú hamburguesa (móvil)
    menu?.addEventListener("click", () => {
        navWrapper?.classList.toggle("show");
        menu?.classList.toggle("is-active");
    });

    // Función para manejar el estado del fondo
    const handleHeaderScroll = () => {
        if (window.scrollY > 0) {
            navContainer?.classList.add("on-scroll");
        } else {
            navContainer?.classList.remove("on-scroll");
        }
    };

    // Verificar al cargar la página
    handleHeaderScroll();

    // Verificar al hacer scroll
    window.addEventListener("scroll", handleHeaderScroll);
</script>
